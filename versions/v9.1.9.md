
# Oppdatering v9.1.9 - Mammoth Hang Fix (Word Safety)

Denne oppdateringen l√∏ser en kritisk feil der innlastingen av Word-dokumenter "hang" (fr√∏s) hvis dokumentet inneholdt spesielle grafikktyper (som EMF/WMF vektorbilder) som nettleseren ikke st√∏tter.

### üõ°Ô∏è Kritiske endringer:

1.  **Safety Timeout p√• Bildeoptimalisering**:
    *   Lagt inn en tidsfrist p√• **1.5 sekunder** i `optimizeImage` i `fileService.ts`.
    *   Hvis et bilde inne i en Word-fil tar lengre tid enn dette √• √•pne (f.eks. fordi formatet er ukjent for Canvas), avbryter systemet fors√∏ket og bruker r√•dataene i stedet.
    *   Dette hindrer at `mammoth.convertToHtml` blir st√•ende og vente i evigheter p√• en `onload` event som aldri kommer.

2.  **MIME-filter**:
    *   `optimizeImage` pr√∏ver n√• kun √• optimalisere st√∏ttede web-formater (`jpeg`, `png`, `webp`, `bmp`). Andre formater (som `wmf`, `emf`) slippes igjennom uendret for √• unng√• krasj.
    *   I `geminiService` filtreres n√• bildevedlegg slik at kun st√∏ttede formater (`jpeg`, `png`, `webp`, `heic`) sendes til API-et. Dette forebygger 400 Bad Request feil.

### Teknisk:
*   Oppdatert `optimizeImage` i `fileService.ts`.
*   Oppdatert `analyzeTextContent` i `geminiService.ts`.
*   Systemversjon: **v9.1.9**.
